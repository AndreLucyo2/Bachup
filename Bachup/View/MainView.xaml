<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:model="clr-namespace:Bachup.Model"
    xmlns:vm="clr-namespace:Bachup.ViewModel"
    x:Class="Bachup.View.MainView"
    DataContext="{DynamicResource MainViewModel}"
    Title="Bachup" Height="729" Width="844"
    TextElement.Foreground="{DynamicResource MaterialDesignBody}"
    TextElement.FontWeight="Regular"
    TextElement.FontSize="12"
    TextOptions.TextFormattingMode="Ideal"
    TextOptions.TextRenderingMode="Auto"
    Background="{DynamicResource MaterialDesignPaper}"
    FontFamily="{DynamicResource MaterialDesignFont}"
    MinWidth="635" MinHeight="550"
    Top="{Binding WindowTop}">
    <Window.Resources>
        <vm:MainViewModel x:Key="MainViewModel"/>
    </Window.Resources>
    <materialDesign:DialogHost Identifier="RootDialog">
        <Grid>
            <Grid.Resources>
                <ResourceDictionary>
                    <ResourceDictionary.MergedDictionaries>
                        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Button.xaml" />
                        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.PopupBox.xaml" />
                        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.TextBlock.xaml" />
                    </ResourceDictionary.MergedDictionaries>
                </ResourceDictionary>
            </Grid.Resources>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="277"/>
                <ColumnDefinition Width="559*"/>
            </Grid.ColumnDefinitions>
            <materialDesign:ColorZone
                Mode="PrimaryMid"
                Padding="16" Grid.ColumnSpan="2">
                <DockPanel>
                    <ToggleButton
                        Style="{StaticResource MaterialDesignSwitchAccentToggleButton}"
                        VerticalAlignment="Center"
                        DockPanel.Dock="Right" 
                        ToolTip="Toggle Color Mode"
                        IsChecked="{Binding DarkMode}"
                        Command="{Binding SetThemeCommand}"/>
                    <TextBlock
                        VerticalAlignment="Center"
                        DockPanel.Dock="Right"
                        Style="{StaticResource MaterialDesignBody2TextBlock}"
                        Margin="0,0,10,0"
                        Text="{Binding ThemeName}"/>
                    <Button
                        Style="{StaticResource MaterialDesignToolForegroundButton}"
                        DockPanel.Dock="Right"
                        Margin="0,0,20,0"
                        ToolTip="Change Theme Color"
                        Command="{Binding ChangeThemeColorCommand}">
                        <materialDesign:PackIcon
                            Kind="Colorize"
                            Height="24"
                            Width="24" />
                    </Button>
                    <Button
                        Style="{DynamicResource MaterialDesignToolForegroundButton}"
                        Margin="0 0 0 0"
                        Panel.ZIndex="0"
                        Command="{Binding AddBachupGroupCommand}">
                        <materialDesign:PackIcon
                            Kind="Plus" Height="28" Width="28" RenderTransformOrigin="0.536,-0.345" />
                    </Button>
                    <StackPanel
                        Orientation="Horizontal"
                        materialDesign:RippleAssist.IsCentered="True"/>
                </DockPanel>
            </materialDesign:ColorZone>
            <TreeView 
                x:Name="treeView" 
                Margin="0,64,0,0"
                ItemsSource="{Binding Bachup}"
                Background="{DynamicResource MaterialDesignFlatButtonClick}"
                BorderBrush="{DynamicResource PrimaryHueDarkBrush}" BorderThickness="0, 0, .5, 0"            
                >
                <TreeView.Resources>
                    <HierarchicalDataTemplate DataType="{x:Type model:BachupGroup}" ItemsSource="{Binding BachupItems}">
                        <TextBlock Text="{Binding Name}" Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                    </HierarchicalDataTemplate>
                    <DataTemplate DataType="{x:Type model:BachupItem}">
                        <TextBlock Text="{Binding Name}" Style="{StaticResource MaterialDesignBody2TextBlock}"/>
                    </DataTemplate>
                </TreeView.Resources>
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectedItemChanged">
                        <i:InvokeCommandAction Command="{Binding SelectItemCommand}" CommandParameter="{Binding ElementName=treeView, Path=SelectedItem}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </TreeView>
            <ScrollViewer 
                Margin="0,64,0,0"
                HorizontalScrollBarVisibility="Disabled"
                
                VerticalScrollBarVisibility="Auto" Grid.Column="1">
                <ContentControl
                    Content="{Binding SelectedViewModel}" 
                    HorizontalContentAlignment="Center" />
            </ScrollViewer>

        </Grid>
    </materialDesign:DialogHost>
</Window>
